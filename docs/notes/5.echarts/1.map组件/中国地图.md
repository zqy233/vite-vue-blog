# 实现中国地图

## 实现步骤

1. 定义一个有宽高的echart元素
2. 定义地图的json
3. 导入echarts，使用echarts的registerMap方法注册地图json
4. 获取这个dom，使用echarts的init方法
5. 设置好相应option
6. 使用init出来的echarts实例的setOption方法

## 入门实例

vue3+typescript中使用

```vue
<script setup lang="ts">
import { init, registerMap } from "echarts"
import chinaMap from "./assets/china.json"
import { ref, nextTick } from "vue"
const chart = ref<HTMLElement | null>(null)
// echarts配置属性
const option = {
  series: [
    {
      type: "map",
      map: "chinamap", // 注意，这里的map值要与registerMap的第一个参数一致
    }
  ]
}

nextTick(() => {
  registerMap("chinamap", chinaMap)
  const echart = init(chart.value as HTMLElement)
  echart.setOption(option)
})
</script>

<template>
  <div ref="chart" id="chart"></div>
</template>

<style>
#chart {
  width: 1200px;
  height: 800px;
}
</style>
```

## 注意点

### series中的map名要与 registerMap的第一个参数一致

```json
const option = {
 ...
 series: [
    {
      type: "map",
      map: "nanjing", 
      ...
    }
  ]  
}
nextTick(() => {
  registerMap("nanjing",chinaMap as any)
  ...
})
```

## option属性介绍

| 属性         | 说明                            |
| ------------ | ------------------------------- |
| map          | 使用 registerMap 注册的地图名称 |
| label        | 设置文字相关                    |
| itemStyle    | 设置背景颜色，边框颜色等        |
| emphasis     | 设置悬浮高亮相关                |
| select       | 设置选中相关                    |
| roam         | 设置是否放大缩小放大            |
| scaleLimit   | 设置放大缩小的限制              |
| selectedMode | 设置选中的模式，单选还是多选    |
| left         | 设置地图组件在容器中的左位置    |
| right        | 设置地图组件在容器中的右位置    |

## 实战案例

```vue
<script setup lang="ts">
import { init, registerMap } from "echarts"
import chinaMap from "./assets/china.json"

const chart = ref<HTMLElement | null>(null)
var option = {
  tooltip: {
    //鼠标hover是提示信息
    show: true, //不显示提示标签
    formatter: "{b}", //提示标签格式
    backgroundColor: "#ff7f50", //提示标签背景颜色
    textStyle: {
      color: "#fff",
      fontSize: "20"
    } //提示标签字体颜色
  },
  visualMap: {
    //视觉映射组件()
    type: "continuous", //连续型
    min: 0,
    max: 150,
    left: 990,
    top: 800,
    text: ["150", "0"], // 文本，默认为数值文本
    textGap: 10, //文本与图形之间的距离
    itemWidth: 40, //图形的宽
    itemHeight: 200, //突刺是哪个的高
    calculable: true, //是否显示拖动手柄
    textStyle: {
      color: "#fff",
      fontSize: 25
    }, //省份标签字体颜色
    //align:"left",
    //inverse: true, //反向
    inRange: {
      //地图颜色变化
      color: ["#3246FB", "#24DD57", "#FDD52C"]
    }
    // outOfRange:{
    // 	symbolSize: [100, 100]
    // }
  },
  series: [
    {
      type: "map",
      color: "red",
      mapType: "china",
      roam: "false", //是否开启缩放平移
      label: {
        //标签字体样式
        position: "inside",
        normal: {
          //正常情况下显示效果
          show: true, //显示省份标签
          textStyle: {
            color: "#fff",
            fontSize: 20
          } //省份标签字体颜色
        },
        emphasis: {
          //对应的鼠标悬浮效果
          show: true,
          textStyle: {
            color: "#800080"
          }
        }
      },
      itemStyle: {
        normal: {
          borderWidth: 2, //区域边框宽度
          borderColor: "#fff", //区域边框颜色
          //areaColor: "#ffefd5", //区域颜色
          fontSize: "30"
        },
        emphasis: {
          borderWidth: 2,
          borderColor: "#3246FB"
          //areaColor: "red",
        }
      },
      data: [
        {
          name: "北京",
          value: 2500
        },
        {
          name: "天津",
          value: Math.round(Math.random() * 100)
        },
        {
          name: "上海",
          value: Math.round(Math.random() * 100)
        },
        {
          name: "重庆",
          value: Math.round(Math.random() * 100)
        },
        {
          name: "河北",
          value: Math.round(Math.random() * 100)
        },
        {
          name: "河南",
          value: Math.round(Math.random() * 100)
        },
        {
          name: "云南",
          value: Math.round(Math.random() * 100)
        },
        {
          name: "辽宁",
          value: Math.round(Math.random() * 100)
        },
        {
          name: "黑龙江",
          value: Math.round(Math.random() * 100)
        },
        {
          name: "湖南",
          value: Math.round(Math.random() * 100)
        },
        {
          name: "安徽",
          value: Math.round(Math.random() * 100)
        },
        {
          name: "山东",
          value: Math.round(Math.random() * 100)
        },
        {
          name: "新疆",
          value: Math.round(Math.random() * 100)
        },
        {
          name: "江苏",
          value: Math.round(Math.random() * 100)
        },
        {
          name: "浙江",
          value: Math.round(Math.random() * 100)
        },
        {
          name: "江西",
          value: Math.round(Math.random() * 100)
        },
        {
          name: "湖北",
          value: Math.round(Math.random() * 100)
        },
        {
          name: "广西",
          value: Math.round(Math.random() * 100)
        },
        {
          name: "甘肃",
          value: Math.round(Math.random() * 100)
        },
        {
          name: "山西",
          value: Math.round(Math.random() * 100)
        },
        {
          name: "内蒙古",
          value: Math.round(Math.random() * 100)
        },
        {
          name: "陕西",
          value: Math.round(Math.random() * 100)
        },
        {
          name: "吉林",
          value: Math.round(Math.random() * 100)
        },
        {
          name: "福建",
          value: Math.round(Math.random() * 100)
        },
        {
          name: "贵州",
          value: Math.round(Math.random() * 100)
        },
        {
          name: "广东",
          value: Math.round(Math.random() * 100)
        },
        {
          name: "青海",
          value: Math.round(Math.random() * 100)
        },
        {
          name: "西藏",
          value: Math.round(Math.random() * 100)
        },
        {
          name: "四川",
          value: Math.round(Math.random() * 100)
        },
        {
          name: "宁夏",
          value: Math.round(Math.random() * 100)
        },
        {
          name: "海南",
          value: Math.round(Math.random() * 100)
        },
        {
          name: "台湾",
          value: Math.round(Math.random() * 100)
        },
        {
          name: "香港",
          value: Math.round(Math.random() * 100)
        },
        {
          name: "澳门",
          value: Math.round(Math.random() * 100)
        }
      ]
    }
  ]
}
nextTick(() => {
  registerMap(
    "china",
    { geoJSON: chinaMap  as GeoJSONSourceInput},
    {
      妈祖: {
        // 左上角经度
        left: 120.178644,
        // 左上角纬度
        top: 24.84237,
        // 经度横跨的范围
        width: 0.21
      },
      金门: {
        left: 119.847492,
        top: 24.270233,
        width: 0.21
      }
    }
  )
  const echart = init(chart.value as HTMLElement)
  echart.setOption(option)
})
</script>

<template>
  <div ref="chart" id="chart"></div>
</template>

<style>
#chart {
  width: 1200px;
  height: 800px;
}
</style>
```

