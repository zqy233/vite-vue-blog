## 对应关系

Excel与`js-xlsx`之间的关系:

| Excel名词                 | js-xlsx中的抽象类型 |
| ------------------------- | ------------------- |
| 工作簿                    | workBook            |
| 工作表                    | Sheets              |
| Excel引用样式(单元格地址) | cellAddress         |
| 单元格                    | cell                |

有了这个基本的对应关系我们就可以轻松的理解后续的操作,例如在我们使用Excel的过程中,获取一个数据的流程如下:

1. 打开工作簿
2. 打开一个工作表
3. 选中一片区域或者一个单元格
4. 针对数据进行操作
5. 保存(另存为)

那么在`js-xlsx`中获取一个单元格内容的[操作如下](https://link.segmentfault.com/?enc=ady%2FEBUgzMhT%2BNUHeOE0Jw%3D%3D.sVsJJuuCBu002%2BAT%2BxzfOf1wHiZJN8lQx2unVz7bYCGEWFjES0ehlqCwGin6EtT8vjjf2ai7ShvVggoz5eaHVw%3D%3D):

```js
// 先不要关心我们的workbook对象是从哪里来的
var first_sheet_name = workbook.SheetNames[0]; // 获取工作簿中的工作表名字
var address_of_cell = 'A1'; // 提供一个单元格下标
var worksheet = workbook.Sheets[first_sheet_name]; // 获取对应的工作表对象
var desired_cell = worksheet[address_of_cell]; // 获取对应单元格下标的单元格对象
var desired_value = (desired_cell ? desired_cell.v : undefined);// 获取对应单元格中的数据
```

一旦我们的Excel文件被解析那么这个Excel表中的所有内容都会被解析上面的这个对象.而且这整个过程是同步完成的.

所以我们可以使用键的方式来直接获取数据,在上面的例子中我们就利用键一层层的向下获取数据.

上图中常用的键一共有两个:

- `SheetNames`以字符串数组的形式保存了所有的工作表的名称
- Sheets下的内容都是工作表对象,而键名就是`SheetNames`中包含的名字

而Excel的数据单位由小到大有如下排序如下:

- 单元格
- 工作表
- 工作簿

#### 单元格格式

在Excel中单元格有多种格式,而`js-xlsx`会将其解析为对应的JavaScript的格式.

**常见格式**如下:

| 键   | 描述                                   |
| ---- | -------------------------------------- |
| v    | 源数据(未经处理的数据)                 |
| w    | 格式化后的文本(如果能够被格式化)       |
| t    | 单元格类型(具体类型请看下方的表格)     |
| r    | 解码后的富文本(如果可以被解码)         |
| h    | 渲染成HTML格式的富文本(如果可以被解码) |
| c    | 单元格注释                             |
| z    | 格式化成字符串的数值(如果需要的话)     |

## API

`js-xlsx`提供的接口非常清晰主要分为两类:

- `xlsx`对象本身提供的功能
  - 解析数据
  - 导出数据
- `utils`工具类
  - 将数据添加到数据表对象上
  - 将二维数组以及符合格式的对象或者HTML转为工作表对象
  - 将工作簿转为另外一种数据格式
  - 行,列,范围之间的转码和解码
  - 工作簿操作
  - 单元格操作