## vue

```sh
npm i -s html2canvas jspdf
```

main.js中挂载

```js
import Vue from "vue"
import App from "./App.vue"
import html2Canvas from "html2canvas"
import JsPDF from "jspdf"
const usePdf = {
  install(Vue) {
    Vue.prototype.getPdf = function (title) {
      html2Canvas(document.querySelector("#pdfDom"), {
        // allowTaint: true 表示允许跨越的图片
        allowTaint: true
      }).then(function (canvas) {
        let contentWidth = canvas.width
        let contentHeight = canvas.height
        let imgWidth = contentWidth
        let imgHeight = contentHeight
        // 生成canvas截图，1表示生成的截图质量（0-1）
        let pageData = canvas.toDataURL("image/jpeg", 1.0)
        // new JsPDF接收三个参数，landscape表示横向（默认不填是纵向），打印单位和纸张尺寸
        let PDF = new JsPDF("landscape", "pt", "a4")
        // 调用addImage方法，第一个参数表示生成的截图内容，第二个参数表示图片格式，第三个参数表示距纸张左侧的距离，第四个参数表示距纸张上方的距离，第五个参数表示生成截图的image的宽度，第六个参数表示生成截图的image的高度
        PDF.addImage(pageData, "JPEG", 20, 20, imgWidth, imgHeight)
        // 调用save方法生成pdf文件
        PDF.save(title + ".pdf")
      })
    }
  }
}
Vue.config.productionTip = false
Vue.use(usePdf)
new Vue({
  render: h => h(App)
}).$mount("#app")

```

页面中使用

```js
<template>
  <div id="pdfDom">
    <div>首页</div>
    <button type="button" class="btn btn-primary" @click="getPdf('测试导出pdf')">导出PDF</button>
  </div>
</template>

<style>
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}
#pdfDom {
  height: 100vh;
  background-color: pink;
}
</style>

```

多页面

```js
import Vue from "vue"
import App from "./App.vue"
import html2Canvas from "html2canvas"
import JsPDF from "jspdf"
const usePdf = {
  install(Vue) {
    Vue.prototype.getPdf = function (title) {
      html2Canvas(document.querySelector("#pdfDom"), {
        // allowTaint: true 表示允许跨越的图片
        allowTaint: true
      }).then(function (canvas) {
        // a4纸的正常尺寸是宽592.28，高是841.89
        const pageWidth = 592.28
        const pageHeight = 841.89
        // 设置内容的宽高
        const contentWidth = canvas.width
        const contentHeight = canvas.height
        // 默认的偏移量
        let position = 0
        // 设置生成图片的宽高
        const imgCanvasWidth = pageWidth
        // const imgCanvasHeight = (841.89 / contentWidth) * contentHeight
        const imgCanvasHeight = contentHeight
        let imageHeight = imgCanvasHeight
        // 生成canvas截图，1表示生成的截图质量（0-1）
        let pageData = canvas.toDataURL("image/jpeg", 1.0)
        // new JsPDF接收三个参数，landscape表示横向（默认不填是纵向），打印单位和纸张尺寸
        let PDF = new JsPDF("landscape", "pt", "a4")
        // 当内容不超过a4纸一页的情况下
        if (imageHeight < pageHeight) {
          // 调用addImage方法，第一个参数表示生成的截图内容，第二个参数表示图片格式，第三个参数表示距纸张左侧的距离，第四个参数表示距纸张上方的距离，第五个参数表示生成截图的image的宽度，第六个参数表示生成截图的image的高度
          PDF.addImage(pageData, "JPEG", 20, 20, imgCanvasWidth, imgCanvasHeight)
        } else {
          // 当内容超过a4纸一页的情况下，需要增加一页
          while (imageHeight > 0) {
            PDF.addImage(pageData, "JPEG", 20, position, imgCanvasWidth, imgCanvasHeight)
            imageHeight -= pageHeight
            position -= pageHeight
            // 避免添加空白页
            if (imageHeight > 0) {
              PDF.addPage()
            }
          }
        }
        // 调用save方法生成pdf文件
        PDF.save(title + ".pdf")
      })
    }
  }
}
Vue.config.productionTip = false
Vue.use(usePdf)
new Vue({
  render: h => h(App)
}).$mount("#app")

```

