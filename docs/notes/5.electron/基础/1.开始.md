# 开始

## 下载模板

```sh
yarn create electron-app my=app
```

## 运行项目

```sh
yarn start
```

## 主进程中配置

```js
const createWindow = () => {
  // Create the browser window
  const mainWindow = new BrowserWindow({
    width: 800,
    height: 600,
    webPreferences: {
       // 是否可使用node混合(浏览器中调用node方法)，默认是false
      nodeIntegration: true,
      // 只能在预加载脚本中使用node，而页面中不行，这样是为了安全
      contextIsolation: false,
      // 允许使用webview
      webviewTag: true
    }
  })
```

## 入门示例

拖拽文件，获取文件信息，浏览器中调用node方法读取文件内容

index.html

```html
<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Hello World!</title>
    <link rel="stylesheet" href="index.css" />
  </head>
  <body>
    <h2 id="holder">拖入此上传文件内容</h2>
    <div>
      <h1>
        读取的文件内容
        <span id="readList"></span>
      </h1>
    </div>
  </body>
  <script src="./render.js"></script>
</html>
```

render.js

```js
let holder = document.querySelector("#holder")
let readlist = document.querySelector("#readList")
let fs = require("fs")
holder.addEventListener("drop", e => {
  e.preventDefault()
  e.stopPropagation()
  console.log(e)
  for (const file of e.dataTransfer.files) {
    console.log(file)
    fs.readFile(file.path, (err, data) => {
      if (err) return console.log(err)
      readlist.innerHTML = file.name + "/" + data
    })
  }
})
holder.addEventListener("dragover", e => {
  e.preventDefault()
  e.stopPropagation()
})
```

## 清除webview缓存

```js
let webview = document.querySelector("webview")

setInterval(() => {
  webview.getWebContents().session.clearCache(() => {
    webview.reload()
  })
}, 1000)
```

